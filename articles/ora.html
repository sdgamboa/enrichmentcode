<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="enrichmentcode">
<title>ORA with EnrichmentBrowser, phyper, and fisher.test • enrichmentcode</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ORA with EnrichmentBrowser, phyper, and fisher.test">
<meta property="og:description" content="enrichmentcode">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">enrichmentcode</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ora.html">ORA with EnrichmentBrowser, phyper, and fisher.test</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>ORA with EnrichmentBrowser, phyper, and fisher.test</h1>
            
      
      
      <div class="d-none name"><code>ora.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">EnrichmentBrowser</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="create-example-data">Create example data<a class="anchor" aria-label="anchor" href="#create-example-data"></a>
</h2>
<p>Create example data using the functions in the EnrichmentBrowser
package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">123</span></span>
<span><span class="va">sig_gen_fdr</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co">#FDR threshold for significant genes in the DA</span></span>
<span></span>
<span><span class="co">## Create SummarizedExperiment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EnrichmentBrowser/man/makeExampleData.html" class="external-link">makeExampleData</a></span><span class="op">(</span>what<span class="op">=</span><span class="st">"SE"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Run Differential abundance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EnrichmentBrowser/man/deAna.html" class="external-link">deAna</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a list of ten signatures</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EnrichmentBrowser/man/makeExampleData.html" class="external-link">makeExampleData</a></span><span class="op">(</span>what<span class="op">=</span><span class="st">"gs"</span>, gnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n_unique_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">gs</span>, use.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The SummarizedExperiment (SE) contains 100 unique genes in total:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span></span>
<span><span class="co">#&gt; class: SummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 100 12 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(1): exprs</span></span>
<span><span class="co">#&gt; rownames(100): g1 g2 ... g99 g100</span></span>
<span><span class="co">#&gt; rowData names(4): FC limma.STAT PVAL ADJ.PVAL</span></span>
<span><span class="co">#&gt; colnames(12): s1 s2 ... s11 s12</span></span>
<span><span class="co">#&gt; colData names(2): GROUP BLOCK</span></span></code></pre></div>
<p>There are 91 unique genes across all signatures.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_unique_g</span></span>
<span><span class="co">#&gt; [1] 91</span></span></code></pre></div>
<p>Individual lengths of the signatures:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">gs</span>, <span class="va">length</span><span class="op">)</span></span>
<span><span class="co">#&gt;  gs1  gs2  gs3  gs4  gs5  gs6  gs7  gs8  gs9 gs10 </span></span>
<span><span class="co">#&gt;   17   17   25   18   17   17   19   18   19   21</span></span></code></pre></div>
<p>Define significant genes (adjusted pvalue &lt; 0.1):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sig.genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">ADJ.PVAL</span> <span class="op">&lt;</span> <span class="va">sig_gen_fdr</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sig.genes</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 72</span></span></code></pre></div>
<p>Two of the signatures (gs1 and gs2) will be composed of significantly
DA genes entirely:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">sig.genes</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">gs</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">sig.genes</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gs</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>   </span>
<span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">gs</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sig.genes</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  gs1  gs2  gs3  gs4  gs5  gs6  gs7  gs8  gs9 gs10 </span></span>
<span><span class="co">#&gt; 1.00 1.00 0.76 0.44 0.65 0.94 0.68 0.72 0.74 0.57</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-ora">Run ORA<a class="anchor" aria-label="anchor" href="#run-ora"></a>
</h2>
<p>In this analysis, we are using all of the original 10 signatures:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ea.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EnrichmentBrowser/man/sbea.html" class="external-link">sbea</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"ora"</span>, se <span class="op">=</span> <span class="va">se</span>, gs <span class="op">=</span> <span class="va">gs</span>, perm <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    alpha <span class="op">=</span> <span class="va">sig_gen_fdr</span>, <span class="co"># FDR threshold for significant genes in the DA</span></span>
<span>    padj.method <span class="op">=</span> <span class="st">"fdr"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">ea.res</span><span class="op">$</span><span class="va">res.tbl</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">PVAL</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">GENE.SET</th>
<th align="right">NR.GENES</th>
<th align="right">NR.SIG.GENES</th>
<th align="right">PVAL</th>
<th align="right">ADJ.PVAL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00195</td>
<td align="right">0.00975</td>
</tr>
<tr class="even">
<td align="left">gs2</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00195</td>
<td align="right">0.00975</td>
</tr>
<tr class="odd">
<td align="left">gs6</td>
<td align="right">17</td>
<td align="right">16</td>
<td align="right">0.01890</td>
<td align="right">0.06300</td>
</tr>
<tr class="even">
<td align="left">gs3</td>
<td align="right">25</td>
<td align="right">19</td>
<td align="right">0.40600</td>
<td align="right">0.99900</td>
</tr>
<tr class="odd">
<td align="left">gs9</td>
<td align="right">19</td>
<td align="right">14</td>
<td align="right">0.55300</td>
<td align="right">0.99900</td>
</tr>
<tr class="even">
<td align="left">gs8</td>
<td align="right">18</td>
<td align="right">13</td>
<td align="right">0.61700</td>
<td align="right">0.99900</td>
</tr>
<tr class="odd">
<td align="left">gs7</td>
<td align="right">19</td>
<td align="right">13</td>
<td align="right">0.75600</td>
<td align="right">0.99900</td>
</tr>
<tr class="even">
<td align="left">gs5</td>
<td align="right">17</td>
<td align="right">11</td>
<td align="right">0.85200</td>
<td align="right">0.99900</td>
</tr>
<tr class="odd">
<td align="left">gs10</td>
<td align="right">21</td>
<td align="right">12</td>
<td align="right">0.97500</td>
<td align="right">0.99900</td>
</tr>
<tr class="even">
<td align="left">gs4</td>
<td align="right">18</td>
<td align="right">8</td>
<td align="right">0.99900</td>
<td align="right">0.99900</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="reproduce-manually-what-sbea-does">Reproduce “manually” what sbea does<a class="anchor" aria-label="anchor" href="#reproduce-manually-what-sbea-does"></a>
</h2>
<p>To inspect the results more in detail, let’s reproduce the code
implemented in EnrichmentBrowser, but adding information about the
number of genes in the background as well.</p>
<p>EnrichmentBrowser uses the <code>phyper</code> function for ORA.</p>
<p>The following snippets of code were taken from the EnrichmentBrowser
package (in Bioconductor):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myORA</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">se</span>, <span class="va">gs</span>, <span class="va">sig.genes</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">## Get a subset of signatures and genes in the SE for further analysis</span></span>
<span>    <span class="va">GS.MIN.SIZE</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span>    <span class="va">GS.MAX.SIZE</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span></span>
<span>    <span class="co">## Subset of the original SE.</span></span>
<span>    <span class="co">## This depends on the genes available in the signatures database </span></span>
<span>    <span class="va">igenes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">newSE</span> <span class="op">&lt;-</span> <span class="va">se</span><span class="op">[</span><span class="va">igenes</span>,<span class="op">]</span></span>
<span></span>
<span>    <span class="co">## Subset of the genes in the signatures</span></span>
<span>    <span class="va">newGS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">gs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="va">s</span><span class="op">[</span><span class="va">s</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">igenes</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">lens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="va">newGS</span><span class="op">)</span></span>
<span>    <span class="va">newGS</span> <span class="op">&lt;-</span> <span class="va">newGS</span><span class="op">[</span><span class="va">lens</span> <span class="op">&gt;=</span> <span class="va">GS.MIN.SIZE</span> <span class="op">&amp;</span> <span class="va">lens</span> <span class="op">&lt;=</span> <span class="va">GS.MAX.SIZE</span><span class="op">]</span></span>
<span>    <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">file</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sink.html" class="external-link">sink</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">f</span><span class="op">)</span></span>
<span>    <span class="va">cmat</span> <span class="op">&lt;-</span> <span class="fu">safe</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/safe/man/getCmatrix.html" class="external-link">getCmatrix</a></span><span class="op">(</span><span class="va">newGS</span>, as.matrix <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sink.html" class="external-link">sink</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">close</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span>    <span class="va">newSE</span> <span class="op">&lt;-</span> <span class="va">newSE</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cmat</span><span class="op">)</span>,<span class="op">]</span> </span>
<span></span>
<span>    <span class="co">## Subset of the original number of significant genes</span></span>
<span>    <span class="va">isig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">newSE</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sig.genes</span></span>
<span>    <span class="va">nr.sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">isig</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co">## Run ORA with phyper</span></span>
<span>    <span class="va">sig.cmat</span> <span class="op">&lt;-</span> <span class="va">cmat</span> <span class="op">&amp;</span> <span class="va">isig</span></span>
<span>    <span class="va">ovlp.sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">sig.cmat</span><span class="op">)</span></span>
<span>    <span class="va">gs.sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">cmat</span><span class="op">)</span> </span>
<span>    <span class="va">uni.sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">newSE</span><span class="op">)</span> <span class="op">-</span> <span class="va">gs.sizes</span> </span>
<span>    <span class="va">gs.ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Hypergeometric.html" class="external-link">phyper</a></span><span class="op">(</span></span>
<span>        q <span class="op">=</span> <span class="va">ovlp.sizes</span> <span class="op">-</span> <span class="fl">1</span>, <span class="co"># number of significant genes in the signature (minus 1)</span></span>
<span>        m <span class="op">=</span> <span class="va">gs.sizes</span>, <span class="co"># number of genes in the signature (significant or not)</span></span>
<span>        n <span class="op">=</span> <span class="va">uni.sizes</span>, <span class="co"># number of genes not in the signature (significant or not)</span></span>
<span>        k <span class="op">=</span> <span class="va">nr.sigs</span>, <span class="co"># total number of significant genes (in the signature or not)</span></span>
<span>        lower.tail <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> </span>
<span>    </span>
<span>    <span class="va">res_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>        gene_set_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cmat</span><span class="op">)</span>,</span>
<span>        genes_in_set <span class="op">=</span> <span class="va">gs.sizes</span>,</span>
<span>        sig_genes_in_set <span class="op">=</span> <span class="va">ovlp.sizes</span>,</span>
<span>        p_value <span class="op">=</span> <span class="va">gs.ps</span>,</span>
<span>        genes_not_in_set <span class="op">=</span> <span class="va">uni.sizes</span>,</span>
<span>        total_sig_genes <span class="op">=</span> <span class="va">nr.sigs</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">p_value</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        rest_tbl <span class="op">=</span> <span class="va">res_tbl</span>,</span>
<span>        newSE <span class="op">=</span> <span class="va">newSE</span>,</span>
<span>        newGS <span class="op">=</span> <span class="va">newGS</span>,</span>
<span>        nr.sigs <span class="op">=</span> <span class="va">nr.sigs</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">my_ora</span> <span class="op">&lt;-</span> <span class="fu">myORA</span><span class="op">(</span><span class="va">se</span>, <span class="va">gs</span>, <span class="va">sig.genes</span><span class="op">)</span></span>
<span><span class="va">my_ora</span><span class="op">$</span><span class="va">rest_tbl</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="16%">
<col width="14%">
<col width="19%">
<col width="11%">
<col width="19%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="left">gene_set_name</th>
<th align="right">genes_in_set</th>
<th align="right">sig_genes_in_set</th>
<th align="right">p_value</th>
<th align="right">genes_not_in_set</th>
<th align="right">total_sig_genes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.0019546</td>
<td align="right">76</td>
<td align="right">67</td>
</tr>
<tr class="even">
<td align="left">gs2</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.0019546</td>
<td align="right">76</td>
<td align="right">67</td>
</tr>
<tr class="odd">
<td align="left">gs6</td>
<td align="right">17</td>
<td align="right">16</td>
<td align="right">0.0188942</td>
<td align="right">76</td>
<td align="right">67</td>
</tr>
<tr class="even">
<td align="left">gs3</td>
<td align="right">25</td>
<td align="right">19</td>
<td align="right">0.4062891</td>
<td align="right">68</td>
<td align="right">67</td>
</tr>
<tr class="odd">
<td align="left">gs9</td>
<td align="right">19</td>
<td align="right">14</td>
<td align="right">0.5528098</td>
<td align="right">74</td>
<td align="right">67</td>
</tr>
<tr class="even">
<td align="left">gs8</td>
<td align="right">18</td>
<td align="right">13</td>
<td align="right">0.6169761</td>
<td align="right">75</td>
<td align="right">67</td>
</tr>
<tr class="odd">
<td align="left">gs7</td>
<td align="right">19</td>
<td align="right">13</td>
<td align="right">0.7560032</td>
<td align="right">74</td>
<td align="right">67</td>
</tr>
<tr class="even">
<td align="left">gs5</td>
<td align="right">17</td>
<td align="right">11</td>
<td align="right">0.8516972</td>
<td align="right">76</td>
<td align="right">67</td>
</tr>
<tr class="odd">
<td align="left">gs10</td>
<td align="right">21</td>
<td align="right">12</td>
<td align="right">0.9750319</td>
<td align="right">72</td>
<td align="right">67</td>
</tr>
<tr class="even">
<td align="left">gs4</td>
<td align="right">18</td>
<td align="right">8</td>
<td align="right">0.9989302</td>
<td align="right">75</td>
<td align="right">67</td>
</tr>
</tbody>
</table>
<p>Note that after the analysis, the total number of genes in the SE is
reduced. This reduction depends on the intersection between the total
unique genes across the whole list/collection/database of signatures and
the genes present in the SE.</p>
<p>Updated number of genes (reduced):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_ora</span><span class="op">$</span><span class="va">newSE</span></span>
<span><span class="co">#&gt; class: SummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 93 12 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(1): exprs</span></span>
<span><span class="co">#&gt; rownames(93): g1 g10 ... g98 g99</span></span>
<span><span class="co">#&gt; rowData names(4): FC limma.STAT PVAL ADJ.PVAL</span></span>
<span><span class="co">#&gt; colnames(12): s1 s2 ... s11 s12</span></span>
<span><span class="co">#&gt; colData names(2): GROUP BLOCK</span></span></code></pre></div>
<p>Updated number of significant genes (reduced):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_ora</span><span class="op">$</span><span class="va">nr.sigs</span></span>
<span><span class="co">#&gt; [1] 67</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="check-one-signature-with-different-accompanying-sets-of-signatures">Check one signature with different accompanying sets of
signatures<a class="anchor" aria-label="anchor" href="#check-one-signature-with-different-accompanying-sets-of-signatures"></a>
</h2>
<p>So, if the number of unique genes in the collection/database of
signatures changes, the background will change as well even when the SE
and an a target signature are the same:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ora</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EnrichmentBrowser/man/sbea.html" class="external-link">sbea</a></span><span class="op">(</span></span>
<span>        method<span class="op">=</span><span class="st">"ora"</span>, se<span class="op">=</span><span class="va">se</span>, gs<span class="op">=</span><span class="va">gs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span>, perm<span class="op">=</span><span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>, padj.method <span class="op">=</span> <span class="st">"fdr"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">output</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">ora</span><span class="op">$</span><span class="va">res.tbl</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"nsigs_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">output</span>, .id <span class="op">=</span> <span class="st">"n_gs"</span><span class="op">)</span></span>
<span><span class="va">output</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">GENE.SET</span> <span class="op">==</span> <span class="st">"gs1"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">n_gs</th>
<th align="left">GENE.SET</th>
<th align="right">NR.GENES</th>
<th align="right">NR.SIG.GENES</th>
<th align="right">PVAL</th>
<th align="right">ADJ.PVAL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">1.00000</td>
<td align="right">1.000000</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">1.00000</td>
<td align="right">1.000000</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.06000</td>
<td align="right">0.090000</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00886</td>
<td align="right">0.017720</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00368</td>
<td align="right">0.009200</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00503</td>
<td align="right">0.015090</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00484</td>
<td align="right">0.016940</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00497</td>
<td align="right">0.019880</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00347</td>
<td align="right">0.015615</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00195</td>
<td align="right">0.009750</td>
</tr>
</tbody>
</table>
<p>In the example above, the input SE and the signature of interest
(gs1) were the same, but the p-value changed depending on the number of
unique genes present across all signatures.</p>
<p>Total number of genes left in the SE:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">output2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">output2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">myORA</span><span class="op">(</span><span class="va">se</span>, <span class="va">gs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span>, <span class="va">sig.genes</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">output2</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"nsigs_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">output2</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">newSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  nsigs_1  nsigs_2  nsigs_3  nsigs_4  nsigs_5  nsigs_6  nsigs_7  nsigs_8 </span></span>
<span><span class="co">#&gt;       17       28       48       58       69       72       79       83 </span></span>
<span><span class="co">#&gt;  nsigs_9 nsigs_10 </span></span>
<span><span class="co">#&gt;       86       93</span></span></code></pre></div>
<p>Let’s use our custom function created above to reproduce the results
using the EnrichemntBrowser functions, but now adding the number of
genes in the background:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_tbl2</span> <span class="op">&lt;-</span> <span class="va">output2</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">.x</span><span class="op">[[</span><span class="st">"rest_tbl"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"n_gs"</span><span class="op">)</span></span>
<span><span class="va">res_tbl2</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gene_set_name</span> <span class="op">==</span> <span class="st">"gs1"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="9%">
<col width="14%">
<col width="13%">
<col width="17%">
<col width="10%">
<col width="17%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="left">n_gs</th>
<th align="left">gene_set_name</th>
<th align="right">genes_in_set</th>
<th align="right">sig_genes_in_set</th>
<th align="right">p_value</th>
<th align="right">genes_not_in_set</th>
<th align="right">total_sig_genes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">nsigs_1</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">1.0000000</td>
<td align="right">0</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">nsigs_2</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">1.0000000</td>
<td align="right">11</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="left">nsigs_3</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.0599992</td>
<td align="right">31</td>
<td align="right">42</td>
</tr>
<tr class="even">
<td align="left">nsigs_4</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.0088570</td>
<td align="right">41</td>
<td align="right">46</td>
</tr>
<tr class="odd">
<td align="left">nsigs_5</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.0036792</td>
<td align="right">52</td>
<td align="right">52</td>
</tr>
<tr class="even">
<td align="left">nsigs_6</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.0050332</td>
<td align="right">55</td>
<td align="right">55</td>
</tr>
<tr class="odd">
<td align="left">nsigs_7</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.0048449</td>
<td align="right">62</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="left">nsigs_8</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.0049709</td>
<td align="right">66</td>
<td align="right">63</td>
</tr>
<tr class="odd">
<td align="left">nsigs_9</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.0034654</td>
<td align="right">69</td>
<td align="right">64</td>
</tr>
<tr class="even">
<td align="left">nsigs_10</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.0019546</td>
<td align="right">76</td>
<td align="right">67</td>
</tr>
</tbody>
</table>
<p>Let’s add a signature for background:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">background_sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">background_sig</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 93</span></span></code></pre></div>
<p>Running the ORA:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">output3</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">input_gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span>, <span class="va">background_sig</span><span class="op">)</span></span>
<span>    <span class="va">ora_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EnrichmentBrowser/man/sbea.html" class="external-link">sbea</a></span><span class="op">(</span></span>
<span>        method <span class="op">=</span> <span class="st">"ora"</span>, se <span class="op">=</span> <span class="va">se</span>, gs <span class="op">=</span> <span class="va">input_gs</span>, perm <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>        padj.method <span class="op">=</span> <span class="st">"fdr"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">output3</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">ora_3</span><span class="op">$</span><span class="va">res.tbl</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">output3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"nsigs_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">output3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">output3</span>, .id <span class="op">=</span> <span class="st">"n_gs"</span><span class="op">)</span></span>
<span><span class="va">output3</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">GENE.SET</span> <span class="op">==</span> <span class="st">"gs1"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">n_gs</th>
<th align="left">GENE.SET</th>
<th align="right">NR.GENES</th>
<th align="right">NR.SIG.GENES</th>
<th align="right">PVAL</th>
<th align="right">ADJ.PVAL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00195</td>
<td align="right">0.003900</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00195</td>
<td align="right">0.002925</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00195</td>
<td align="right">0.003900</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00195</td>
<td align="right">0.004875</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00195</td>
<td align="right">0.005850</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00195</td>
<td align="right">0.006825</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00195</td>
<td align="right">0.007800</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00195</td>
<td align="right">0.008775</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00195</td>
<td align="right">0.009750</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">gs1</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0.00195</td>
<td align="right">0.010725</td>
</tr>
</tbody>
</table>
<p>Above, the pvalue was the same in all cases. FDR will still vary
depending on the number and values of the p-values being adjusted.</p>
</div>
<div class="section level2">
<h2 id="reproduce-with-fisher-exact-test">Reproduce with Fisher exact test<a class="anchor" aria-label="anchor" href="#reproduce-with-fisher-exact-test"></a>
</h2>
<p>Now, let’s just create a custom function to achieve the same results,
but using the <code>fisher.test</code> function instead of the
<code>phyper</code> function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myFisher</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mySE</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">newSE</span></span>
<span>    <span class="va">mySigs</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">newGS</span></span>
<span>    <span class="va">all_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mySE</span><span class="op">)</span></span>
<span>    <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mySigs</span><span class="op">)</span><span class="op">)</span> </span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mySigs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sig.genes</span><span class="op">)</span></span>
<span>        <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">mySigs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sig.genes</span><span class="op">)</span></span>
<span>        <span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">all_genes</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sig.genes</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">!</span><span class="va">all_genes</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">mySigs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="va">all_genes</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sig.genes</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">!</span><span class="va">all_genes</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">mySigs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">ct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span>, <span class="va">d</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">ct</span>, alternative <span class="op">=</span> <span class="st">"g"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>        <span class="va">sig_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mySigs</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>        </span>
<span>        <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sig_name</span>,<span class="va">pval</span>, <span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span>, <span class="va">d</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            <span class="st">"sig_name"</span>, <span class="st">"p_value"</span>,</span>
<span>            <span class="st">"significat_inSignature"</span>, <span class="st">"notSignificant_inSignature"</span>, </span>
<span>            <span class="st">"significant_inBackground"</span>, <span class="st">"notSignificant_inBackground"</span></span>
<span>        <span class="op">)</span></span>
<span>        <span class="va">results</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dat</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">results</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">p_value</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Reproducing the first analysis:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">myFisher</span><span class="op">(</span><span class="va">output2</span><span class="op">[[</span><span class="fl">10</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="6%">
<col width="14%">
<col width="17%">
<col width="20%">
<col width="19%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th align="left">sig_name</th>
<th align="left">p_value</th>
<th align="left">significat_inSignature</th>
<th align="left">notSignificant_inSignature</th>
<th align="left">significant_inBackground</th>
<th align="left">notSignificant_inBackground</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">gs1</td>
<td align="left">0.0019545711216273</td>
<td align="left">17</td>
<td align="left">0</td>
<td align="left">50</td>
<td align="left">26</td>
</tr>
<tr class="even">
<td align="left">gs2</td>
<td align="left">0.0019545711216273</td>
<td align="left">17</td>
<td align="left">0</td>
<td align="left">50</td>
<td align="left">26</td>
</tr>
<tr class="odd">
<td align="left">gs6</td>
<td align="left">0.0188941875090639</td>
<td align="left">16</td>
<td align="left">1</td>
<td align="left">51</td>
<td align="left">25</td>
</tr>
<tr class="even">
<td align="left">gs3</td>
<td align="left">0.406289063434951</td>
<td align="left">19</td>
<td align="left">6</td>
<td align="left">48</td>
<td align="left">20</td>
</tr>
<tr class="odd">
<td align="left">gs9</td>
<td align="left">0.552809778132621</td>
<td align="left">14</td>
<td align="left">5</td>
<td align="left">53</td>
<td align="left">21</td>
</tr>
<tr class="even">
<td align="left">gs8</td>
<td align="left">0.616976128863673</td>
<td align="left">13</td>
<td align="left">5</td>
<td align="left">54</td>
<td align="left">21</td>
</tr>
<tr class="odd">
<td align="left">gs7</td>
<td align="left">0.756003222114287</td>
<td align="left">13</td>
<td align="left">6</td>
<td align="left">54</td>
<td align="left">20</td>
</tr>
<tr class="even">
<td align="left">gs5</td>
<td align="left">0.851697195390683</td>
<td align="left">11</td>
<td align="left">6</td>
<td align="left">56</td>
<td align="left">20</td>
</tr>
<tr class="odd">
<td align="left">gs10</td>
<td align="left">0.975031875470329</td>
<td align="left">12</td>
<td align="left">9</td>
<td align="left">55</td>
<td align="left">17</td>
</tr>
<tr class="even">
<td align="left">gs4</td>
<td align="left">0.99893020201038</td>
<td align="left">8</td>
<td align="left">10</td>
<td align="left">59</td>
<td align="left">16</td>
</tr>
</tbody>
</table>
<p>Reproducing the analysis above with different number of
signatures:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output2</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">myFisher</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"n_sigs"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sig_name</span> <span class="op">==</span> <span class="st">"gs1"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="6%">
<col width="6%">
<col width="14%">
<col width="16%">
<col width="19%">
<col width="17%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th align="left">n_sigs</th>
<th align="left">sig_name</th>
<th align="left">p_value</th>
<th align="left">significat_inSignature</th>
<th align="left">notSignificant_inSignature</th>
<th align="left">significant_inBackground</th>
<th align="left">notSignificant_inBackground</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">nsigs_1</td>
<td align="left">gs1</td>
<td align="left">1</td>
<td align="left">17</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">nsigs_2</td>
<td align="left">gs1</td>
<td align="left">1</td>
<td align="left">17</td>
<td align="left">0</td>
<td align="left">11</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">nsigs_3</td>
<td align="left">gs1</td>
<td align="left">0.0599992079215667</td>
<td align="left">17</td>
<td align="left">0</td>
<td align="left">25</td>
<td align="left">6</td>
</tr>
<tr class="even">
<td align="left">nsigs_4</td>
<td align="left">gs1</td>
<td align="left">0.00885703192529937</td>
<td align="left">17</td>
<td align="left">0</td>
<td align="left">29</td>
<td align="left">12</td>
</tr>
<tr class="odd">
<td align="left">nsigs_5</td>
<td align="left">gs1</td>
<td align="left">0.00367923171661204</td>
<td align="left">17</td>
<td align="left">0</td>
<td align="left">35</td>
<td align="left">17</td>
</tr>
<tr class="even">
<td align="left">nsigs_6</td>
<td align="left">gs1</td>
<td align="left">0.00503321024133239</td>
<td align="left">17</td>
<td align="left">0</td>
<td align="left">38</td>
<td align="left">17</td>
</tr>
<tr class="odd">
<td align="left">nsigs_7</td>
<td align="left">gs1</td>
<td align="left">0.00484492230495556</td>
<td align="left">17</td>
<td align="left">0</td>
<td align="left">43</td>
<td align="left">19</td>
</tr>
<tr class="even">
<td align="left">nsigs_8</td>
<td align="left">gs1</td>
<td align="left">0.00497091954338108</td>
<td align="left">17</td>
<td align="left">0</td>
<td align="left">46</td>
<td align="left">20</td>
</tr>
<tr class="odd">
<td align="left">nsigs_9</td>
<td align="left">gs1</td>
<td align="left">0.00346541294300146</td>
<td align="left">17</td>
<td align="left">0</td>
<td align="left">47</td>
<td align="left">22</td>
</tr>
<tr class="even">
<td align="left">nsigs_10</td>
<td align="left">gs1</td>
<td align="left">0.0019545711216273</td>
<td align="left">17</td>
<td align="left">0</td>
<td align="left">50</td>
<td align="left">26</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Session info ───────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span></span>
<span><span class="co">#&gt;  version  R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">#&gt;  os       Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt;  system   x86_64, linux-gnu</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language en</span></span>
<span><span class="co">#&gt;  collate  C.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    C.UTF-8</span></span>
<span><span class="co">#&gt;  tz       UTC</span></span>
<span><span class="co">#&gt;  date     2024-02-09</span></span>
<span><span class="co">#&gt;  pandoc   2.19.2 @ /usr/bin/ (via rmarkdown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Packages ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package             </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version    </span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span></span>
<span><span class="co">#&gt;  abind                  1.4-5       <span style="color: #555555;">2016-07-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  annotate               1.80.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  AnnotationDbi          1.64.1      <span style="color: #555555;">2023-11-03</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  Biobase              * 2.62.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  BiocGenerics         * 0.48.1      <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  Biostrings             2.70.2      <span style="color: #555555;">2024-01-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Bioconduc~</span></span></span>
<span><span class="co">#&gt;  bit                    4.0.5       <span style="color: #555555;">2022-11-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  bit64                  4.0.5       <span style="color: #555555;">2020-08-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  bitops                 1.0-7       <span style="color: #555555;">2021-04-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  blob                   1.2.4       <span style="color: #555555;">2023-03-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  bslib                  0.6.1       <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  cachem                 1.0.8       <span style="color: #555555;">2023-05-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  cli                    3.6.2       <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  crayon                 1.5.2       <span style="color: #555555;">2022-09-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  DBI                    1.2.1       <span style="color: #555555;">2024-01-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  DelayedArray           0.28.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  desc                   1.4.3       <span style="color: #555555;">2023-12-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  digest                 0.6.34      <span style="color: #555555;">2024-01-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  dplyr                * 1.1.4       <span style="color: #555555;">2023-11-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  EnrichmentBrowser    * 2.32.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  evaluate               0.23        <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  fansi                  1.0.6       <span style="color: #555555;">2023-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  fastmap                1.1.1       <span style="color: #555555;">2023-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  fs                     1.6.3       <span style="color: #555555;">2023-07-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  generics               0.1.3       <span style="color: #555555;">2022-07-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  GenomeInfoDb         * 1.38.5      <span style="color: #555555;">2023-12-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Bioconduc~</span></span></span>
<span><span class="co">#&gt;  GenomeInfoDbData       1.2.11      <span style="color: #555555;">2024-02-09</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  GenomicRanges        * 1.54.1      <span style="color: #555555;">2023-10-29</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  glue                   1.7.0       <span style="color: #555555;">2024-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  graph                * 1.80.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  GSEABase               1.64.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  htmltools              0.5.7       <span style="color: #555555;">2023-11-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  httr                   1.4.7       <span style="color: #555555;">2023-08-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  IRanges              * 2.36.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  jquerylib              0.1.4       <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  jsonlite               1.8.8       <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  KEGGgraph              1.62.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  KEGGREST               1.42.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  knitr                  1.45        <span style="color: #555555;">2023-10-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  lattice                0.21-9      <span style="color: #555555;">2023-10-01</span> <span style="color: #555555;">[3]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  lifecycle              1.0.4       <span style="color: #555555;">2023-11-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  limma                  3.58.1      <span style="color: #555555;">2023-10-31</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  magrittr               2.0.3       <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  Matrix                 1.6-1.1     <span style="color: #555555;">2023-09-18</span> <span style="color: #555555;">[3]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  MatrixGenerics       * 1.14.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  matrixStats          * 1.2.0       <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  memoise                2.0.1       <span style="color: #555555;">2021-11-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pillar                 1.9.0       <span style="color: #555555;">2023-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pkgconfig              2.0.3       <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pkgdown                2.0.7       <span style="color: #555555;">2022-12-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">any (@2.0.7)</span></span></span>
<span><span class="co">#&gt;  png                    0.1-8       <span style="color: #555555;">2022-11-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  purrr                * 1.0.2       <span style="color: #555555;">2023-08-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  R6                     2.5.1       <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  ragg                   1.2.7       <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  RCurl                  1.98-1.14   <span style="color: #555555;">2024-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  Rgraphviz              2.46.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  rlang                  1.1.3       <span style="color: #555555;">2024-01-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rmarkdown              2.25        <span style="color: #555555;">2023-09-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  RSQLite                2.3.5       <span style="color: #555555;">2024-01-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  S4Arrays               1.2.0       <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  S4Vectors            * 0.40.2      <span style="color: #555555;">2023-11-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Bioconduc~</span></span></span>
<span><span class="co">#&gt;  safe                   3.42.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  sass                   0.4.8       <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  sessioninfo            1.2.2       <span style="color: #555555;">2021-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">any (@1.2.2)</span></span></span>
<span><span class="co">#&gt;  SparseArray            1.2.3       <span style="color: #555555;">2023-12-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Bioconduc~</span></span></span>
<span><span class="co">#&gt;  SparseM                1.81        <span style="color: #555555;">2021-02-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  statmod                1.5.0       <span style="color: #555555;">2023-01-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  stringi                1.8.3       <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  stringr                1.5.1       <span style="color: #555555;">2023-11-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  SummarizedExperiment * 1.32.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  systemfonts            1.0.5       <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  textshaping            0.3.7       <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  tibble                 3.2.1       <span style="color: #555555;">2023-03-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  tidyselect             1.2.0       <span style="color: #555555;">2022-10-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  utf8                   1.2.4       <span style="color: #555555;">2023-10-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  vctrs                  0.6.5       <span style="color: #555555;">2023-12-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  xfun                   0.41        <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  XML                    3.99-0.16.1 <span style="color: #555555;">2024-01-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  xtable                 1.8-4       <span style="color: #555555;">2019-04-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  XVector                0.42.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  yaml                   2.3.8       <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  zlibbioc               1.48.0      <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [1] /home/runner/work/_temp/Library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [2] /opt/R/4.3.2/lib/R/site-library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [3] /opt/R/4.3.2/lib/R/library</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">──────────────────────────────────────────────────────────────────────────────</span></span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
